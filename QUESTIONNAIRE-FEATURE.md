# 📝 问卷功能使用说明

## 🎯 **功能概述**

基于用户填写的6个问卷问题，调用大模型生成个性化的理想伴侣文字描述。

## 🛠️ **技术实现**

### **推荐大模型**
- **主要方案**: Replicate + Llama-2-70B
- **成本**: ~$0.002-0.004/次生成
- **优势**: 已集成，成本低，质量好

### **备选方案**
- **OpenAI GPT-3.5**: $0.0004-0.009/次
- **Claude-3-Sonnet**: $0.0006-0.0009/次

## 📋 **问卷问题设计**

### **6个核心问题**
1. **理想伴侣的生活态度** (必填)
   - 冒险型、平静型、野心型、关爱型

2. **最重要的核心价值观** (必填)
   - 诚实透明、善良同理、独立自主、幽默积极

3. **理想伴侣的休闲方式** (必填)
   - 户外探索、阅读学习、社交活动、志愿服务

4. **理想伴侣的沟通风格** (必填)
   - 开放直接、深思熟虑、轻松愉快、支持鼓励

5. **理想伴侣的人生观** (必填)
   - 乐观积极、现实务实、热情驱动、随和轻松

6. **对"灵魂感"的定义** (选填)
   - 开放性问题，用户自由描述

## 🔧 **API接口**

### **生成描述API**
```typescript
POST /api/generate-description

Body: {
  answers: string[],      // 问卷答案数组
  language: 'zh|en|ja|ko' // 用户语言
}

Response: {
  success: boolean,
  description: string,    // 生成的文字描述
  language: string,
  timestamp: string
}
```

### **测试页面**
访问 `/test-description` 可以测试API功能

## 🎨 **用户体验流程**

1. **问卷弹窗** - 首页自动弹出
2. **问题回答** - 6个问题，支持多语言
3. **AI生成** - 调用大模型生成描述
4. **结果展示** - 美观的弹窗显示描述
5. **分享功能** - 支持分享到社交平台
6. **继续流程** - 引导用户生成照片

## 💡 **特色功能**

### **多语言支持**
- 问卷内容完全本地化
- 生成描述支持4种语言
- 智能语言检测

### **智能提示词**
- 根据用户答案动态构建提示词
- 多语言提示词优化
- 确保生成质量

### **容错机制**
- API失败时自动使用模拟数据
- 网络超时处理
- 用户友好的错误提示

## 🚀 **部署说明**

### **环境变量**
```bash
# 必需
REPLICATE_API_TOKEN=your_token_here

# 可选
ENABLE_AI_GENERATION=true  # 默认true
```

### **测试步骤**
1. 启动开发服务器: `npm run dev`
2. 访问首页，填写问卷
3. 查看生成的文字描述
4. 测试 `/test-description` 页面

## 📊 **成本估算**

### **Replicate Llama-2-70B**
- 单次生成: ~$0.003
- 月1000次: ~$3
- 月10000次: ~$30

### **使用建议**
- 开发阶段使用模拟模式
- 生产环境配置真实API
- 监控使用量和成本

## 🔮 **未来扩展**

### **功能增强**
- 保存用户问卷历史
- 多种描述风格选择
- 个性化推荐算法

### **社交功能**
- 用户作品展示
- 点赞评论系统
- 分享到社交平台

### **变现功能**
- 高级描述功能
- 无限生成次数
- 批量生成选项

---

*最后更新: 2024-07-20*
*功能状态: ✅ 已完成* 